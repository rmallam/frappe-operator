apiVersion: vyogo.tech/v1alpha1
kind: FrappeBench
metadata:
  name: ocp-restricted-bench
  namespace: frappe-test
  annotations:
    frappe.tech/skip-bench-build: "1"
    frappe.tech/storage-access-mode: "ReadWriteMany"
spec:
  frappeVersion: "v15.0.0"
  storageClassName: "ocs-external-storagecluster-cephfs"
  imageConfig:
    repository: "image-registry.openshift-image-registry.svc:5000/frappe-test/erpnext"
    tag: "ocp-v6"
    pullPolicy: Always
  
  redisConfig:
    type: redis
    image: public.ecr.aws/docker/library/redis:7.2-alpine
  
  # Security Context - OpenShift compatible (UID 1001, GID 0)
  # Matches the default operator behavior but shown explicitly for reference
  security:
    podSecurityContext:
      runAsUser: 1001  # OpenShift arbitrary UID standard
      runAsGroup: 0    # Root group for arbitrary UID support
      fsGroup: 0       # Root group for filesystem permissions
    securityContext:
      runAsUser: 1001
      runAsGroup: 0
      allowPrivilegeEscalation: false
      capabilities:
        drop: ["ALL"]

  apps:
    - name: frappe
      source: image
    - name: erpnext
      source: image
